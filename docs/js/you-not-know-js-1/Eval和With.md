---
title: Eval和With
author: kebobo
date: '2023-10-09'
---

## Eval和With功能介绍

Eval: 可以对一段包含一个或多个声明的“代码”字符串进行演算，并借此来修改已经存在的词法作用域（在运行时）
With：通过将一个对象的引用当作作用域来处理，将对象的属性当作作用域中的标识符来处理，从而创建了一个新的词法作用域（同样是在运行时）。

## Eval和With的作用域

## Eval和With的性能问题

对于这两个功能，我们是不建议使用的，因为在严格模式下，他们都表现出与非严格模式下不一样的行为。

- Eval会产生自己的作用域。如果字符串代码中有声明变量或者函数，是无法被外部调用的。
- With被完全禁止使用

另外一个不推荐使用的理由是：在编译阶段，这两个特性不会进行性能优化，导致运行变慢。

原因是词法分析阶段无法明确知道eval(..)会接收到什么代码，这些代码会如何对作用域进行修改（非严格模式下），也无法知道传递给with用来创建新词法作用域的对象的内容是什么。当引擎在代码中发现了eval(..)或with，它只能简单地假设关于标识符（变量、函数）位置的判断都是无效的（我的理解：当前作用域里面的变量、函数都 **不会进行查找优化** ）。

正是因为这样，出现了eval(..)或者with的地方，所有优化都是没有意义的，因此引擎不会做任何优化。
